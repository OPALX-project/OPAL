<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPAL (Object Oriented Parallel Accelerator Library): src/Classic/AbsBeamline/Undulator.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "AMSmath.js", "AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPAL (Object Oriented Parallel Accelerator Library)
   &#160;<span id="projectnumber">2022.1</span>
   </div>
   <div id="projectbrief">OPAL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_296421ed9f186178f5a30b71a29b17b4.html">Classic</a></li><li class="navelem"><a class="el" href="../../dir_8d41666f1ccd2816980cb50fd25d2b43.html">AbsBeamline</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Undulator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/daf/a00830.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Class Undulator</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//   Defines all the methods used by the Undulator element.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//   The Undulator element uses a full wave solver from the</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//   MITHRA library, see &lt;https://github.com/aryafallahi/mithra/&gt;.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Copyright (c) 2020, Arnau Alb√†, Paul Scherrer Institut, Villigen PSI, Switzerland</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// All rights reserved.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Implemented as part of the MSc thesis</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// &quot;Start-to-End Modelling of the AWA Micro-Bunched Electron Cooling POP-Experiment&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// This file is part of OPAL.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// OPAL is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// (at your option) any later version.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// along with OPAL. If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d6e/a00833.html">AbsBeamline/Undulator.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/de6/a00548.html">AbsBeamline/BeamlineVisitor.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d95/a00989.html">Algorithms/PartBunchBase.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d6b/a01853.html">Physics/Physics.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dce/a01859.html">Physics/Units.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;mithra/classes.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;mithra/database.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;mithra/datainput.h&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;mithra/fdtdSC.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;mithra/fieldvector.h&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;mithra/readdata.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;mithra/stdinclude.h&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../d8/d4f/a12119.html">Inform</a>* <a class="code" href="../../d9/daf/a00830.html#af2090682b58787f3464d7bf5b07b3ea8">gmsg</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a8e655e610052ab025af7746d7ffad928">   42</a></span>&#160;<a class="code" href="../../d8/dd0/a05235.html#a8e655e610052ab025af7746d7ffad928">Undulator::Undulator</a>() : <a class="code" href="../../d8/dd0/a05235.html">Undulator</a>(<span class="stringliteral">&quot;&quot;</span>) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a42d6889b13fb60226b3cf65d8f41d522">   45</a></span>&#160;<a class="code" href="../../d8/dd0/a05235.html#a8e655e610052ab025af7746d7ffad928">Undulator::Undulator</a>(<span class="keyword">const</span> <a class="code" href="../../d8/dd0/a05235.html">Undulator</a>&amp; right)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    : <a class="code" href="../../d2/d61/a05043.html">Component</a>(right),</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      k_m(right.k_m),</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      lambda_m(right.lambda_m),</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      numPeriods_m(right.numPeriods_m),</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      angle_m(right.angle_m),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      fname_m(right.fname_m),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      meshLength_m(right.meshLength_m),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      meshResolution_m(right.meshResolution_m),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      truncationOrder_m(right.truncationOrder_m),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      totalTime_m(right.totalTime_m),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      dtBunch_m(right.dtBunch_m),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      hasBeenSimulated_m(right.hasBeenSimulated_m) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aaf4eb382d6f80bdcdc88676ff6466ede">   60</a></span>&#160;<a class="code" href="../../d8/dd0/a05235.html#a8e655e610052ab025af7746d7ffad928">Undulator::Undulator</a>(<span class="keyword">const</span> std::string&amp; <a class="code" href="../../dc/d8f/a04133.html#ac673bc430bdc3fdaa09f7becf98ef267">name</a>)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    : <a class="code" href="../../d2/d61/a05043.html">Component</a>(<a class="code" href="../../dc/d8f/a04133.html#ac673bc430bdc3fdaa09f7becf98ef267">name</a>),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      k_m(0.0),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      lambda_m(0.0),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      numPeriods_m(0),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      angle_m(0.0),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      fname_m(<span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      meshLength_m(3, 0.0),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      meshResolution_m(3, 0.0),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      truncationOrder_m(2),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      totalTime_m(0.0),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      dtBunch_m(0.0),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      hasBeenSimulated_m(false) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a35268072fa021e069dc6e941b58133b0">   75</a></span>&#160;<a class="code" href="../../d8/dd0/a05235.html#a35268072fa021e069dc6e941b58133b0">Undulator::~Undulator</a>() {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aeff0610dcacc322348e9600183cd213c">   78</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#aeff0610dcacc322348e9600183cd213c">Undulator::accept</a>(<a class="code" href="../../de/d93/a05019.html">BeamlineVisitor</a>&amp; visitor)<span class="keyword"> const </span>{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    visitor.visitUndulator(*<span class="keyword">this</span>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a8d469abb98100bd326f390689b60a127">   82</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a8d469abb98100bd326f390689b60a127">Undulator::initialise</a>(</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../d9/d06/a04735.html">PartBunchBase&lt;double, 3&gt;</a>* bunch, <span class="keywordtype">double</span>&amp; <span class="comment">/*startField*/</span>, <span class="keywordtype">double</span>&amp; <span class="comment">/*endField*/</span>) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="../../d2/d61/a05043.html#aa925fb2ed301caa4b8788f8ad4f61629">RefPartBunch_m</a> = bunch;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a48a0a0717818072f2c25d1c8cdb562a3">   87</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a48a0a0717818072f2c25d1c8cdb562a3">Undulator::apply</a>(</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="../../d9/d06/a04735.html">PartBunchBase&lt;double, 3&gt;</a>* itsBunch, <a class="code" href="../../dc/d4e/a05331.html">CoordinateSystemTrafo</a> <span class="keyword">const</span>&amp; refToLocalCSTrafo) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../d8/d4f/a12119.html">Inform</a> msg(<span class="stringliteral">&quot;MITHRA FW solver &quot;</span>, *<a class="code" href="../../d9/daf/a00830.html#af2090682b58787f3464d7bf5b07b3ea8">gmsg</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// Get local coordinates w.r.t. undulator.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localNum = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a1f81217882e2f010b529837e0abc8889">getLocalNum</a>();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; localNum; ++i) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i] = refToLocalCSTrafo.<a class="code" href="../../dc/d4e/a05331.html#acacde969cf75ea57d36f24896874c6a0">transformTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i]);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i] = refToLocalCSTrafo.<a class="code" href="../../dc/d4e/a05331.html#ae2537ef2597a313e3f6852c8175dd356">rotateTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i]);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a644c68187c47b47efa54ab2cf9ef3a27">calcBeamParameters</a>();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Bunch before undulator in local coordinate system: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a4d0601f83df76c9e78d4f190bfb42ba4">print</a>(msg);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    MITHRA::helloMessage();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Prepare parameters for full wave solver.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    MITHRA::BunchInitialize bunchInit;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    bunchInit.bunchType_         = <span class="stringliteral">&quot;other&quot;</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    bunchInit.numberOfParticles_ = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a3473f0bbd78f0e387277bb72490d9ee3">getTotalNum</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    bunchInit.cloudCharge_ =</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a3473f0bbd78f0e387277bb72490d9ee3">getTotalNum</a>() * itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a19aacd7d2904a811460d487ade713b9a">getChargePerParticle</a>() / (-<a class="code" href="../../d4/dd0/a04537.html#ab9b5c9c33385e7d484177d8ee38e22f2">Physics::q_e</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    bunchInit.initialGamma_ = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a446fb70114c17e69382ae950734baec3">get_gamma</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; 3; ++d)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        bunchInit.initialDirection_[d] = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#ac3bd99adc985bee33077c21f9d744f15">get_pmean</a>()[d];</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    bunchInit.initialDirection_ /= <a class="code" href="../../d0/d85/a00908.html#a7a49daa94331dcd77650d976f3030012">euclidean_norm</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#ac3bd99adc985bee33077c21f9d744f15">get_pmean</a>());</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    MITHRA::Bunch bunch;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    bunch.bunchInit_.push_back(bunchInit);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    bunch.timeStep_ = <a class="code" href="../../d8/dd0/a05235.html#a5c76de67b4ee712c6a6cd3142552e5a5">getDtBunch</a>();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Bunch parameters have been transferred to the full-wave solver.&quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    MITHRA::Undulator undulator;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    undulator.k_      = <a class="code" href="../../d8/dd0/a05235.html#a0f81a0c0e9cd2cf50882705665df1cf1">getK</a>();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    undulator.lu_     = <a class="code" href="../../d8/dd0/a05235.html#ae861ce4400cafe5119446a625a194127">getLambda</a>();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    undulator.length_ = <a class="code" href="../../d8/dd0/a05235.html#aa6e841635fc0347fb004308631f510dd">getNumPeriods</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    undulator.theta_  = <a class="code" href="../../d8/dd0/a05235.html#ab3ac86465d2e7c5476c489850f722934">getAngle</a>();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">double</span> lFringe    = 2 * undulator.lu_;                     <span class="comment">// Fringe field length is 2*lu.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    undulator.dist_ = lFringe - itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#aaa01b2db4d248d28fff4412e55eaa6a2">get_maxExtent</a>()[2];  <span class="comment">// Bunch-head to undulator distance.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::vector&lt;MITHRA::Undulator&gt; undulators;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    undulators.push_back(undulator);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Undulator parameters have been transferred to the full-wave solver.&quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    MITHRA::Mesh mesh;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    mesh.initialize();</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    mesh.lengthScale_    = 1.0;  <span class="comment">// OPAL uses metres.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    mesh.timeScale_      = 1.0;  <span class="comment">// OPAL uses seconds.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    mesh.meshCenter_     = MITHRA::FieldVector&lt;double&gt;(0.0);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    mesh.meshLength_     = <a class="code" href="../../d8/dd0/a05235.html#a101b1754532ab305e53866381a22b4bd">getMeshLength</a>();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    mesh.meshResolution_ = <a class="code" href="../../d8/dd0/a05235.html#abd4d8f266b4c482eead40212f7dcc7cd">getMeshResolution</a>();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    mesh.totalTime_      = <a class="code" href="../../d8/dd0/a05235.html#a92c1b58c7d4e20f9201e165cb37551ea">getTotalTime</a>();</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// If simulation time is not given, run the full-wave solver until the end of the undulator.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (mesh.totalTime_ == 0)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        mesh.totalDist_ = lFringe + undulator.lu_ * undulator.length_;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    mesh.truncationOrder_  = <a class="code" href="../../d8/dd0/a05235.html#a895a2e7cb1510c9a756ec67765da1e0c">getTruncationOrder</a>();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    mesh.spaceCharge_      = <span class="keyword">true</span>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    mesh.optimizePosition_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Mesh parameters have been transferred to the full-wave solver.&quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    MITHRA::Seed <a class="code" href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">seed</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">seed</a>.a0_ = 0.0; <span class="comment">// initialise unitialised member (see #658)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::vector&lt;MITHRA::ExtField&gt; externalFields;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    std::vector&lt;MITHRA::FreeElectronLaser&gt; FELs;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// Get filename with desired output data.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/dd0/a05235.html#a283bd5c14cffceb9eda51d072f5e96e1">fname_m</a>.empty()) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        std::list&lt;std::string&gt; jobFile = MITHRA::read_file(<a class="code" href="../../d8/dd0/a05235.html#a283bd5c14cffceb9eda51d072f5e96e1">fname_m</a>.c_str());</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        MITHRA::cleanJobFile(jobFile);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        MITHRA::ParseDarius parser(jobFile, mesh, bunch, <a class="code" href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">seed</a>, undulators, externalFields, FELs);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        parser.setJobParameters();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    MITHRA::FdTdSC solver(mesh, bunch, <a class="code" href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">seed</a>, undulators, externalFields, FELs);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Transfer particles to full wave solver and destroy them from itsBunch.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    MITHRA::Charge charge;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    charge.q = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a19aacd7d2904a811460d487ade713b9a">getChargePerParticle</a>() / (-<a class="code" href="../../d4/dd0/a04537.html#ab9b5c9c33385e7d484177d8ee38e22f2">Physics::q_e</a>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; localNum; ++i) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; 3; ++d) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            charge.rnp[d]  = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i][d];</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            charge.gbnp[d] = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i][d];</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        solver.chargeVectorn_.push_back(charge);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#aca3eb11cbe8b8affeae9aef3ba398e75">destroy</a>(localNum, 0, <span class="keyword">true</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Particles have been transferred to the full-wave solver.&quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// Print the parameters for the simulation.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    mesh.show();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    bunch.show();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">seed</a>.show();</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; undulators.size(); i++) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        undulators[i].show();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; externalFields.size(); i++) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        externalFields[i].show();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// Run the full-wave solver.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    timeval simulationStart;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    gettimeofday(&amp;simulationStart, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    solver.solve();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// Get total computational time of the full wave simulation.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    timeval simulationEnd;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    gettimeofday(&amp;simulationEnd, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">double</span> deltaTime = (simulationEnd.tv_usec - simulationStart.tv_usec) * <a class="code" href="../../d0/d3d/a04539.html#a01a383459c2b949c77a2a390249c3af8">Units::us2s</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    deltaTime += (simulationEnd.tv_sec - simulationStart.tv_sec);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;::: Total full wave simulation time [seconds] = &quot;</span> &lt;&lt; deltaTime &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Lorentz Transformation back to undulator local coordinates.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// First you need to get the position of the bunch tail.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">double</span> zMin = 1e100;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = solver.chargeVectorn_.begin(); iter != solver.chargeVectorn_.end(); iter++) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        zMin = <a class="code" href="../../d4/d5e/a03542.html#a7b0fcc46c994cf7a89ae3456787ecdda">std::min</a>(zMin, iter-&gt;rnp[2]);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="../../d4/d5e/a03686.html#a3f4c593649c5ad948ee3e8566bffeda6">allreduce</a>(&amp;zMin, 1, std::less&lt;double&gt;());</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> gammaBeta = solver.gamma_ * solver.beta_;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> factor    = gammaBeta * solver.c0_ * (solver.timeBunch_ + solver.dt_) + lFringe;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = solver.chargeVectorn_.begin(); iter != solver.chargeVectorn_.end(); iter++) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">double</span> dist = zMin - iter-&gt;rnp[2];</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// Lorentz transform.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        iter-&gt;rnp[2] = solver.gamma_ * iter-&gt;rnp[2] + factor;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        iter-&gt;gbnp[2] =</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            solver.gamma_ * iter-&gt;gbnp[2] + gammaBeta * <a class="code" href="../../dc/d2c/a00893.html#aff5fe19fcdf8761618dbaf37b209a9c6">std::sqrt</a>(1 + iter-&gt;gbnp.norm2());</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Shift to bring all particles to same time in lab frame.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">double</span> gammaParticle = <a class="code" href="../../dc/d2c/a00893.html#aff5fe19fcdf8761618dbaf37b209a9c6">std::sqrt</a>(1 + iter-&gt;gbnp.norm2());</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        iter-&gt;rnp[0] += iter-&gt;gbnp[0] / gammaParticle * dist * gammaBeta;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        iter-&gt;rnp[1] += iter-&gt;gbnp[1] / gammaParticle * dist * gammaBeta;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        iter-&gt;rnp[2] += iter-&gt;gbnp[2] / gammaParticle * dist * gammaBeta;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Get total time elapsed in laboratory frame.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    mesh.totalTime_ =</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        solver.gamma_ * (solver.time_ + solver.beta_ / solver.c0_ * (zMin - bunch.zu_));</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// Return particles to itsBunch in local coordinates.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Transferring particles back to OPAL bunch.&quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#ad7244dddace671a9e518f3fe4929f1b9">create</a>(solver.chargeVectorn_.size());</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> dt                          = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a4951c53df6841fd275a56f41fc76bfdf">getdT</a>();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newLocalNum           = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a1f81217882e2f010b529837e0abc8889">getLocalNum</a>();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="../../de/d21/a04545.html#a7a0330f10eb09ae36017c24b9f45365b">std::list&lt;MITHRA::Charge&gt;::iterator</a> iter = solver.chargeVectorn_.begin();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; newLocalNum; ++i) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; 3; ++d) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i][d] = iter-&gt;rnp[d];</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i][d] = iter-&gt;gbnp[d];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a5f3de61e1c65ab5b1f336470ae29d48c">Q</a>[i]  = iter-&gt;q * (-<a class="code" href="../../d4/dd0/a04537.html#ab9b5c9c33385e7d484177d8ee38e22f2">Physics::q_e</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a9e08de7a5c9634721e4ea0fc6ee0d8cd">dt</a>[i] = dt;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        iter++;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#addc3c351123a7c560c34507b2fa67b5c">setT</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#af792389ff15f7f9fe61a13138ff0d6f3">getT</a>() + mesh.totalTime_);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// Transform back to reference coordinate system.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="../../dc/d4e/a05331.html">CoordinateSystemTrafo</a> localToRefCSTrafo = refToLocalCSTrafo.<a class="code" href="../../dc/d4e/a05331.html#ae5f60c7777720c99b382b87952bd9e8a">inverted</a>();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; newLocalNum; ++i) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i] = localToRefCSTrafo.<a class="code" href="../../dc/d4e/a05331.html#acacde969cf75ea57d36f24896874c6a0">transformTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">R</a>[i]);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i] = localToRefCSTrafo.<a class="code" href="../../dc/d4e/a05331.html#ae2537ef2597a313e3f6852c8175dd356">rotateTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">P</a>[i]);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a644c68187c47b47efa54ab2cf9ef3a27">calcBeamParameters</a>();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Update reference particle.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// The reference particle becomes the bunch-centroid after the undulator.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a5d3f889cb1da052c04f1ce823946467f">RefPartR_m</a> = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a85872d4e8a718a8b38f259f879748eb9">toLabTrafo_m</a>.<a class="code" href="../../dc/d4e/a05331.html#acacde969cf75ea57d36f24896874c6a0">transformTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#abb205db2732109c056b0693e91913912">get_centroid</a>());</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a0e1323e04044303804432d62ce2f68f0">RefPartP_m</a> = itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a85872d4e8a718a8b38f259f879748eb9">toLabTrafo_m</a>.<a class="code" href="../../dc/d4e/a05331.html#ae2537ef2597a313e3f6852c8175dd356">rotateTo</a>(itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#ac3bd99adc985bee33077c21f9d744f15">get_pmean</a>());</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    msg &lt;&lt; <span class="stringliteral">&quot;Bunch after undulator in reference coordinate system: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    itsBunch-&gt;<a class="code" href="../../d9/d06/a04735.html#a4d0601f83df76c9e78d4f190bfb42ba4">print</a>(msg);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#af3ddb42c7dab1949c3b38ab574a4b323">setHasBeenSimulated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a719a1264567c3f02681bec8ee52b8b67">  260</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a719a1264567c3f02681bec8ee52b8b67">Undulator::finalise</a>() {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a83662640cf10e76488c80d6a4fb98a2a">  263</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/dd0/a05235.html#a83662640cf10e76488c80d6a4fb98a2a">Undulator::bends</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aee820dcf4191f34fb18b116181dc5ac3">  267</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#aee820dcf4191f34fb18b116181dc5ac3">Undulator::getDimensions</a>(<span class="keywordtype">double</span>&amp; <span class="comment">/*zBegin*/</span>, <span class="keywordtype">double</span>&amp; <span class="comment">/*zEnd*/</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a027b6937b03cc0656e8c17a78db92848">  270</a></span>&#160;<a class="code" href="../../d5/d0a/a00602.html#a1d3efb4a54c06179c8699d81435593c8">ElementType</a> <a class="code" href="../../d8/dd0/a05235.html#a027b6937b03cc0656e8c17a78db92848">Undulator::getType</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d0a/a00602.html#a1d3efb4a54c06179c8699d81435593c8a42b46db8de99aae5c09001fdfa9ba71f">ElementType::UNDULATOR</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aec072d15f2d5ef51eea627e7c0a90677">  274</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#aec072d15f2d5ef51eea627e7c0a90677">Undulator::setK</a>(<span class="keywordtype">double</span> k) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#af215cd9b3938aebeeaa2e62287f7199d">k_m</a> = k;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a0f81a0c0e9cd2cf50882705665df1cf1">  277</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d8/dd0/a05235.html#a0f81a0c0e9cd2cf50882705665df1cf1">Undulator::getK</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#af215cd9b3938aebeeaa2e62287f7199d">k_m</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a4dc6413a954e4f5cd43fbea79729b8dd">  281</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a4dc6413a954e4f5cd43fbea79729b8dd">Undulator::setLambda</a>(<span class="keywordtype">double</span> lambda) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a144ae01ef70dce11631ec32eef308987">lambda_m</a> = lambda;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#ae861ce4400cafe5119446a625a194127">  284</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d8/dd0/a05235.html#ae861ce4400cafe5119446a625a194127">Undulator::getLambda</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a144ae01ef70dce11631ec32eef308987">lambda_m</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a7b649ce80dd34cdfe9e29849d6f7df20">  288</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a7b649ce80dd34cdfe9e29849d6f7df20">Undulator::setNumPeriods</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> np) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a0484e463f30b6e5da6964be8a80cbbf5">numPeriods_m</a> = np;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aa6e841635fc0347fb004308631f510dd">  291</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dd0/a05235.html#aa6e841635fc0347fb004308631f510dd">Undulator::getNumPeriods</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a0484e463f30b6e5da6964be8a80cbbf5">numPeriods_m</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a0a7556a9541f5fa95b7ac4dda441f1fc">  295</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a0a7556a9541f5fa95b7ac4dda441f1fc">Undulator::setAngle</a>(<span class="keywordtype">double</span> theta) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a0d69e0773a2e3049ecb3c360381c562b">angle_m</a> = theta;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#ab3ac86465d2e7c5476c489850f722934">  298</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d8/dd0/a05235.html#ab3ac86465d2e7c5476c489850f722934">Undulator::getAngle</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a0d69e0773a2e3049ecb3c360381c562b">angle_m</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a544b9bdff49179e91319c86dbd1fff45">  302</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a544b9bdff49179e91319c86dbd1fff45">Undulator::setFilename</a>(<span class="keyword">const</span> std::string&amp; fname) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a283bd5c14cffceb9eda51d072f5e96e1">fname_m</a> = fname;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aa0a312a5ea7791d9af3ee64d8a2c68f9">  305</a></span>&#160;<span class="keyword">const</span> std::string&amp; <a class="code" href="../../d8/dd0/a05235.html#aa0a312a5ea7791d9af3ee64d8a2c68f9">Undulator::getFilename</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a283bd5c14cffceb9eda51d072f5e96e1">fname_m</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a478c3c617bf02247aa068b15d0e56950">  309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a478c3c617bf02247aa068b15d0e56950">Undulator::setMeshLength</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; ml) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#ac1d1ef5a5283299b6e7c9f9434985c20">meshLength_m</a> = ml;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a101b1754532ab305e53866381a22b4bd">  312</a></span>&#160;std::vector&lt;double&gt; <a class="code" href="../../d8/dd0/a05235.html#a101b1754532ab305e53866381a22b4bd">Undulator::getMeshLength</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#ac1d1ef5a5283299b6e7c9f9434985c20">meshLength_m</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#ae19e3bd54cd96e152ac099b467588b36">  316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#ae19e3bd54cd96e152ac099b467588b36">Undulator::setMeshResolution</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; mr) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a1ebe12105fdecb3b95d1161f6a3b9310">meshResolution_m</a> = mr;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#abd4d8f266b4c482eead40212f7dcc7cd">  319</a></span>&#160;std::vector&lt;double&gt; <a class="code" href="../../d8/dd0/a05235.html#abd4d8f266b4c482eead40212f7dcc7cd">Undulator::getMeshResolution</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a1ebe12105fdecb3b95d1161f6a3b9310">meshResolution_m</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a744d3b6f3251e63e3059ee389cfbc5d2">  323</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a744d3b6f3251e63e3059ee389cfbc5d2">Undulator::setTruncationOrder</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> trunOrder) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#afb808bb698d1098fab823f21dac05037">truncationOrder_m</a> = trunOrder;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a895a2e7cb1510c9a756ec67765da1e0c">  326</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dd0/a05235.html#a895a2e7cb1510c9a756ec67765da1e0c">Undulator::getTruncationOrder</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#afb808bb698d1098fab823f21dac05037">truncationOrder_m</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a701f94a34ce6259f03741e59d7c519cf">  330</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#a701f94a34ce6259f03741e59d7c519cf">Undulator::setTotalTime</a>(<span class="keywordtype">double</span> tt) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a2ed1801511511a173222dbe516bd835a">totalTime_m</a> = tt;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a92c1b58c7d4e20f9201e165cb37551ea">  333</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d8/dd0/a05235.html#a92c1b58c7d4e20f9201e165cb37551ea">Undulator::getTotalTime</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a2ed1801511511a173222dbe516bd835a">totalTime_m</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aaa96ea70638125a77630bd8ebd3e9f9f">  337</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#aaa96ea70638125a77630bd8ebd3e9f9f">Undulator::setDtBunch</a>(<span class="keywordtype">double</span> dtb) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#a994492c7c6fd28bc670d0dd1a878ebe9">dtBunch_m</a> = dtb;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#a5c76de67b4ee712c6a6cd3142552e5a5">  340</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d8/dd0/a05235.html#a5c76de67b4ee712c6a6cd3142552e5a5">Undulator::getDtBunch</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#a994492c7c6fd28bc670d0dd1a878ebe9">dtBunch_m</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#af3ddb42c7dab1949c3b38ab574a4b323">  344</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/dd0/a05235.html#af3ddb42c7dab1949c3b38ab574a4b323">Undulator::setHasBeenSimulated</a>(<span class="keywordtype">bool</span> hbs) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="../../d8/dd0/a05235.html#ae715aff40c7d3c21afd7f80d53123573">hasBeenSimulated_m</a> = hbs;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="../../d8/dd0/a05235.html#aa6743ad0c28ad4465cf7eade9e724fc4">  347</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/dd0/a05235.html#aa6743ad0c28ad4465cf7eade9e724fc4">Undulator::getHasBeenSimulated</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dd0/a05235.html#ae715aff40c7d3c21afd7f80d53123573">hasBeenSimulated_m</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div><div class="ttc" id="a01853_html"><div class="ttname"><a href="../../db/d6b/a01853.html">Physics.h</a></div></div>
<div class="ttc" id="a05235_html"><div class="ttname"><a href="../../d8/dd0/a05235.html">Undulator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00031">Undulator.h:31</a></div></div>
<div class="ttc" id="a05235_html_abd4d8f266b4c482eead40212f7dcc7cd"><div class="ttname"><a href="../../d8/dd0/a05235.html#abd4d8f266b4c482eead40212f7dcc7cd">Undulator::getMeshResolution</a></div><div class="ttdeci">std::vector&lt; double &gt; getMeshResolution() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00319">Undulator.cpp:319</a></div></div>
<div class="ttc" id="a05331_html_acacde969cf75ea57d36f24896874c6a0"><div class="ttname"><a href="../../dc/d4e/a05331.html#acacde969cf75ea57d36f24896874c6a0">CoordinateSystemTrafo::transformTo</a></div><div class="ttdeci">Vector_t transformTo(const Vector_t &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dad/a00941_source.html#l00078">CoordinateSystemTrafo.h:78</a></div></div>
<div class="ttc" id="a05235_html_ae861ce4400cafe5119446a625a194127"><div class="ttname"><a href="../../d8/dd0/a05235.html#ae861ce4400cafe5119446a625a194127">Undulator::getLambda</a></div><div class="ttdeci">double getLambda() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00284">Undulator.cpp:284</a></div></div>
<div class="ttc" id="a04735_html_ac3bd99adc985bee33077c21f9d744f15"><div class="ttname"><a href="../../d9/d06/a04735.html#ac3bd99adc985bee33077c21f9d744f15">PartBunchBase::get_pmean</a></div><div class="ttdeci">Vector_t get_pmean() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01135">PartBunchBase.hpp:1135</a></div></div>
<div class="ttc" id="a04735_html_aaa01b2db4d248d28fff4412e55eaa6a2"><div class="ttname"><a href="../../d9/d06/a04735.html#aaa01b2db4d248d28fff4412e55eaa6a2">PartBunchBase::get_maxExtent</a></div><div class="ttdeci">Vector_t get_maxExtent() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01099">PartBunchBase.hpp:1099</a></div></div>
<div class="ttc" id="a04735_html_aca3eb11cbe8b8affeae9aef3ba398e75"><div class="ttname"><a href="../../d9/d06/a04735.html#aca3eb11cbe8b8affeae9aef3ba398e75">PartBunchBase::destroy</a></div><div class="ttdeci">void destroy(size_t M, size_t I, bool doNow=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01994">PartBunchBase.hpp:1994</a></div></div>
<div class="ttc" id="a05235_html_aec072d15f2d5ef51eea627e7c0a90677"><div class="ttname"><a href="../../d8/dd0/a05235.html#aec072d15f2d5ef51eea627e7c0a90677">Undulator::setK</a></div><div class="ttdeci">void setK(double k)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00274">Undulator.cpp:274</a></div></div>
<div class="ttc" id="a04735_html_a5f3de61e1c65ab5b1f336470ae29d48c"><div class="ttname"><a href="../../d9/d06/a04735.html#a5f3de61e1c65ab5b1f336470ae29d48c">PartBunchBase::Q</a></div><div class="ttdeci">ParticleAttrib&lt; double &gt; Q</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00575">PartBunchBase.h:575</a></div></div>
<div class="ttc" id="a05235_html_a701f94a34ce6259f03741e59d7c519cf"><div class="ttname"><a href="../../d8/dd0/a05235.html#a701f94a34ce6259f03741e59d7c519cf">Undulator::setTotalTime</a></div><div class="ttdeci">void setTotalTime(double tt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00330">Undulator.cpp:330</a></div></div>
<div class="ttc" id="a05043_html"><div class="ttname"><a href="../../d2/d61/a05043.html">Component</a></div><div class="ttdoc">Interface for a single beam element. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d06/a00572_source.html#l00050">Component.h:50</a></div></div>
<div class="ttc" id="a03542_html_a7b0fcc46c994cf7a89ae3456787ecdda"><div class="ttname"><a href="../../d4/d5e/a03542.html#a7b0fcc46c994cf7a89ae3456787ecdda">min</a></div><div class="ttdeci">T::PETE_Expr_t::PETE_Return_t min(const PETE_Expr&lt; T &gt; &amp;expr, NDIndex&lt; D &gt; &amp;loc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d5e/a03542_source.html#l00076">ReductionLoc.h:76</a></div></div>
<div class="ttc" id="a05235_html_a144ae01ef70dce11631ec32eef308987"><div class="ttname"><a href="../../d8/dd0/a05235.html#a144ae01ef70dce11631ec32eef308987">Undulator::lambda_m</a></div><div class="ttdeci">double lambda_m</div><div class="ttdoc">Undulator period. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00084">Undulator.h:84</a></div></div>
<div class="ttc" id="a05331_html_ae5f60c7777720c99b382b87952bd9e8a"><div class="ttname"><a href="../../dc/d4e/a05331.html#ae5f60c7777720c99b382b87952bd9e8a">CoordinateSystemTrafo::inverted</a></div><div class="ttdeci">CoordinateSystemTrafo inverted() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dad/a00941_source.html#l00070">CoordinateSystemTrafo.h:70</a></div></div>
<div class="ttc" id="a05235_html_a83662640cf10e76488c80d6a4fb98a2a"><div class="ttname"><a href="../../d8/dd0/a05235.html#a83662640cf10e76488c80d6a4fb98a2a">Undulator::bends</a></div><div class="ttdeci">virtual bool bends() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00263">Undulator.cpp:263</a></div></div>
<div class="ttc" id="a04735_html_ad7244dddace671a9e518f3fe4929f1b9"><div class="ttname"><a href="../../d9/d06/a04735.html#ad7244dddace671a9e518f3fe4929f1b9">PartBunchBase::create</a></div><div class="ttdeci">void create(size_t M)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01984">PartBunchBase.hpp:1984</a></div></div>
<div class="ttc" id="a05235_html_a5c76de67b4ee712c6a6cd3142552e5a5"><div class="ttname"><a href="../../d8/dd0/a05235.html#a5c76de67b4ee712c6a6cd3142552e5a5">Undulator::getDtBunch</a></div><div class="ttdeci">double getDtBunch() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00340">Undulator.cpp:340</a></div></div>
<div class="ttc" id="a05043_html_aa925fb2ed301caa4b8788f8ad4f61629"><div class="ttname"><a href="../../d2/d61/a05043.html#aa925fb2ed301caa4b8788f8ad4f61629">Component::RefPartBunch_m</a></div><div class="ttdeci">PartBunchBase&lt; double, 3 &gt; * RefPartBunch_m</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d06/a00572_source.html#l00191">Component.h:191</a></div></div>
<div class="ttc" id="a05235_html_ae19e3bd54cd96e152ac099b467588b36"><div class="ttname"><a href="../../d8/dd0/a05235.html#ae19e3bd54cd96e152ac099b467588b36">Undulator::setMeshResolution</a></div><div class="ttdeci">void setMeshResolution(const std::vector&lt; double &gt; &amp;mr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00316">Undulator.cpp:316</a></div></div>
<div class="ttc" id="a05235_html_a1ebe12105fdecb3b95d1161f6a3b9310"><div class="ttname"><a href="../../d8/dd0/a05235.html#a1ebe12105fdecb3b95d1161f6a3b9310">Undulator::meshResolution_m</a></div><div class="ttdeci">std::vector&lt; double &gt; meshResolution_m</div><div class="ttdoc">Mesh dx, dy, dz. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00099">Undulator.h:99</a></div></div>
<div class="ttc" id="a03971_html_a3479363bc276c3798e3f3656c66d93ed"><div class="ttname"><a href="../../d0/dce/a03971.html#a3479363bc276c3798e3f3656c66d93ed">endl</a></div><div class="ttdeci">Inform &amp; endl(Inform &amp;inf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dce/a03971_source.html#l00042">Inform.cpp:42</a></div></div>
<div class="ttc" id="a05235_html_aee820dcf4191f34fb18b116181dc5ac3"><div class="ttname"><a href="../../d8/dd0/a05235.html#aee820dcf4191f34fb18b116181dc5ac3">Undulator::getDimensions</a></div><div class="ttdeci">virtual void getDimensions(double &amp;zBegin, double &amp;zEnd) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00267">Undulator.cpp:267</a></div></div>
<div class="ttc" id="a05235_html_af3ddb42c7dab1949c3b38ab574a4b323"><div class="ttname"><a href="../../d8/dd0/a05235.html#af3ddb42c7dab1949c3b38ab574a4b323">Undulator::setHasBeenSimulated</a></div><div class="ttdeci">void setHasBeenSimulated(bool hbs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00344">Undulator.cpp:344</a></div></div>
<div class="ttc" id="a04735_html_a3473f0bbd78f0e387277bb72490d9ee3"><div class="ttname"><a href="../../d9/d06/a04735.html#a3473f0bbd78f0e387277bb72490d9ee3">PartBunchBase::getTotalNum</a></div><div class="ttdeci">size_t getTotalNum() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01900">PartBunchBase.hpp:1900</a></div></div>
<div class="ttc" id="a00830_html_af2090682b58787f3464d7bf5b07b3ea8"><div class="ttname"><a href="../../d9/daf/a00830.html#af2090682b58787f3464d7bf5b07b3ea8">gmsg</a></div><div class="ttdeci">Inform * gmsg</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df8/a02717_source.html#l00061">Main.cpp:61</a></div></div>
<div class="ttc" id="a01859_html"><div class="ttname"><a href="../../d3/dce/a01859.html">Units.h</a></div></div>
<div class="ttc" id="a05235_html_a35268072fa021e069dc6e941b58133b0"><div class="ttname"><a href="../../d8/dd0/a05235.html#a35268072fa021e069dc6e941b58133b0">Undulator::~Undulator</a></div><div class="ttdeci">virtual ~Undulator()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00075">Undulator.cpp:75</a></div></div>
<div class="ttc" id="a04735_html"><div class="ttname"><a href="../../d9/d06/a04735.html">PartBunchBase&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="a05235_html_aa6e841635fc0347fb004308631f510dd"><div class="ttname"><a href="../../d8/dd0/a05235.html#aa6e841635fc0347fb004308631f510dd">Undulator::getNumPeriods</a></div><div class="ttdeci">unsigned int getNumPeriods() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00291">Undulator.cpp:291</a></div></div>
<div class="ttc" id="a05235_html_aa6743ad0c28ad4465cf7eade9e724fc4"><div class="ttname"><a href="../../d8/dd0/a05235.html#aa6743ad0c28ad4465cf7eade9e724fc4">Undulator::getHasBeenSimulated</a></div><div class="ttdeci">bool getHasBeenSimulated() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00347">Undulator.cpp:347</a></div></div>
<div class="ttc" id="a05331_html_ae2537ef2597a313e3f6852c8175dd356"><div class="ttname"><a href="../../dc/d4e/a05331.html#ae2537ef2597a313e3f6852c8175dd356">CoordinateSystemTrafo::rotateTo</a></div><div class="ttdeci">Vector_t rotateTo(const Vector_t &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dad/a00941_source.html#l00088">CoordinateSystemTrafo.h:88</a></div></div>
<div class="ttc" id="a05235_html_a744d3b6f3251e63e3059ee389cfbc5d2"><div class="ttname"><a href="../../d8/dd0/a05235.html#a744d3b6f3251e63e3059ee389cfbc5d2">Undulator::setTruncationOrder</a></div><div class="ttdeci">void setTruncationOrder(unsigned int trunOrder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00323">Undulator.cpp:323</a></div></div>
<div class="ttc" id="a04539_html_a01a383459c2b949c77a2a390249c3af8"><div class="ttname"><a href="../../d0/d3d/a04539.html#a01a383459c2b949c77a2a390249c3af8">Units::us2s</a></div><div class="ttdeci">constexpr double us2s</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/a01859_source.html#l00041">Units.h:41</a></div></div>
<div class="ttc" id="a04735_html_a644c68187c47b47efa54ab2cf9ef3a27"><div class="ttname"><a href="../../d9/d06/a04735.html#a644c68187c47b47efa54ab2cf9ef3a27">PartBunchBase::calcBeamParameters</a></div><div class="ttdeci">void calcBeamParameters()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01267">PartBunchBase.hpp:1267</a></div></div>
<div class="ttc" id="a05235_html_a0f81a0c0e9cd2cf50882705665df1cf1"><div class="ttname"><a href="../../d8/dd0/a05235.html#a0f81a0c0e9cd2cf50882705665df1cf1">Undulator::getK</a></div><div class="ttdeci">double getK() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00277">Undulator.cpp:277</a></div></div>
<div class="ttc" id="a05235_html_a4dc6413a954e4f5cd43fbea79729b8dd"><div class="ttname"><a href="../../d8/dd0/a05235.html#a4dc6413a954e4f5cd43fbea79729b8dd">Undulator::setLambda</a></div><div class="ttdeci">void setLambda(double lambda)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00281">Undulator.cpp:281</a></div></div>
<div class="ttc" id="a05235_html_a544b9bdff49179e91319c86dbd1fff45"><div class="ttname"><a href="../../d8/dd0/a05235.html#a544b9bdff49179e91319c86dbd1fff45">Undulator::setFilename</a></div><div class="ttdeci">void setFilename(const std::string &amp;fname)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00302">Undulator.cpp:302</a></div></div>
<div class="ttc" id="a04537_html_ab9b5c9c33385e7d484177d8ee38e22f2"><div class="ttname"><a href="../../d4/dd0/a04537.html#ab9b5c9c33385e7d484177d8ee38e22f2">Physics::q_e</a></div><div class="ttdeci">constexpr double q_e</div><div class="ttdoc">The elementary charge in As. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6b/a01853_source.html#l00069">Physics.h:69</a></div></div>
<div class="ttc" id="a00602_html_a1d3efb4a54c06179c8699d81435593c8"><div class="ttname"><a href="../../d5/d0a/a00602.html#a1d3efb4a54c06179c8699d81435593c8">ElementType</a></div><div class="ttdeci">ElementType</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0a/a00602_source.html#l00088">ElementBase.h:88</a></div></div>
<div class="ttc" id="a05235_html_a0a7556a9541f5fa95b7ac4dda441f1fc"><div class="ttname"><a href="../../d8/dd0/a05235.html#a0a7556a9541f5fa95b7ac4dda441f1fc">Undulator::setAngle</a></div><div class="ttdeci">void setAngle(double theta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00295">Undulator.cpp:295</a></div></div>
<div class="ttc" id="a04735_html_a0e1323e04044303804432d62ce2f68f0"><div class="ttname"><a href="../../d9/d06/a04735.html#a0e1323e04044303804432d62ce2f68f0">PartBunchBase::RefPartP_m</a></div><div class="ttdeci">Vector_t RefPartP_m</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00591">PartBunchBase.h:591</a></div></div>
<div class="ttc" id="a05235_html_aa0a312a5ea7791d9af3ee64d8a2c68f9"><div class="ttname"><a href="../../d8/dd0/a05235.html#aa0a312a5ea7791d9af3ee64d8a2c68f9">Undulator::getFilename</a></div><div class="ttdeci">const std::string &amp; getFilename() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00305">Undulator.cpp:305</a></div></div>
<div class="ttc" id="a00602_html_a1d3efb4a54c06179c8699d81435593c8a42b46db8de99aae5c09001fdfa9ba71f"><div class="ttname"><a href="../../d5/d0a/a00602.html#a1d3efb4a54c06179c8699d81435593c8a42b46db8de99aae5c09001fdfa9ba71f">ElementType::UNDULATOR</a></div></div>
<div class="ttc" id="a04735_html_a9e08de7a5c9634721e4ea0fc6ee0d8cd"><div class="ttname"><a href="../../d9/d06/a04735.html#a9e08de7a5c9634721e4ea0fc6ee0d8cd">PartBunchBase::dt</a></div><div class="ttdeci">ParticleAttrib&lt; double &gt; dt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00583">PartBunchBase.h:583</a></div></div>
<div class="ttc" id="a04735_html_a446fb70114c17e69382ae950734baec3"><div class="ttname"><a href="../../d9/d06/a04735.html#a446fb70114c17e69382ae950734baec3">PartBunchBase::get_gamma</a></div><div class="ttdeci">double get_gamma() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01061">PartBunchBase.hpp:1061</a></div></div>
<div class="ttc" id="a05235_html_aaa96ea70638125a77630bd8ebd3e9f9f"><div class="ttname"><a href="../../d8/dd0/a05235.html#aaa96ea70638125a77630bd8ebd3e9f9f">Undulator::setDtBunch</a></div><div class="ttdeci">void setDtBunch(double dtb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00337">Undulator.cpp:337</a></div></div>
<div class="ttc" id="a04735_html_a4d0601f83df76c9e78d4f190bfb42ba4"><div class="ttname"><a href="../../d9/d06/a04735.html#a4d0601f83df76c9e78d4f190bfb42ba4">PartBunchBase::print</a></div><div class="ttdeci">Inform &amp; print(Inform &amp;os)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01753">PartBunchBase.hpp:1753</a></div></div>
<div class="ttc" id="a05235_html_a48a0a0717818072f2c25d1c8cdb562a3"><div class="ttname"><a href="../../d8/dd0/a05235.html#a48a0a0717818072f2c25d1c8cdb562a3">Undulator::apply</a></div><div class="ttdeci">void apply(PartBunchBase&lt; double, 3 &gt; *itsBunch, CoordinateSystemTrafo const &amp;refToLocalCSTrafo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00087">Undulator.cpp:87</a></div></div>
<div class="ttc" id="a05331_html"><div class="ttname"><a href="../../dc/d4e/a05331.html">CoordinateSystemTrafo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dad/a00941_source.html#l00008">CoordinateSystemTrafo.h:8</a></div></div>
<div class="ttc" id="a04549_html_add25cbd96b6ba4bbbc8da3a9805c3dcd"><div class="ttname"><a href="../../d7/d8b/a04549.html#add25cbd96b6ba4bbbc8da3a9805c3dcd">Options::seed</a></div><div class="ttdeci">int seed</div><div class="ttdoc">The current random seed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d4c/a02165_source.html#l00037">Options.cpp:37</a></div></div>
<div class="ttc" id="a05235_html_a895a2e7cb1510c9a756ec67765da1e0c"><div class="ttname"><a href="../../d8/dd0/a05235.html#a895a2e7cb1510c9a756ec67765da1e0c">Undulator::getTruncationOrder</a></div><div class="ttdeci">unsigned int getTruncationOrder() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00326">Undulator.cpp:326</a></div></div>
<div class="ttc" id="a05235_html_ac1d1ef5a5283299b6e7c9f9434985c20"><div class="ttname"><a href="../../d8/dd0/a05235.html#ac1d1ef5a5283299b6e7c9f9434985c20">Undulator::meshLength_m</a></div><div class="ttdeci">std::vector&lt; double &gt; meshLength_m</div><div class="ttdoc">Size of computational domain. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00096">Undulator.h:96</a></div></div>
<div class="ttc" id="a03686_html_a3f4c593649c5ad948ee3e8566bffeda6"><div class="ttname"><a href="../../d4/d5e/a03686.html#a3f4c593649c5ad948ee3e8566bffeda6">allreduce</a></div><div class="ttdeci">void allreduce(const T *input, T *output, int count, Op op)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d4a/a03689_source.html#l00510">GlobalComm.hpp:510</a></div></div>
<div class="ttc" id="a05235_html_a283bd5c14cffceb9eda51d072f5e96e1"><div class="ttname"><a href="../../d8/dd0/a05235.html#a283bd5c14cffceb9eda51d072f5e96e1">Undulator::fname_m</a></div><div class="ttdeci">std::string fname_m</div><div class="ttdoc">Mithra file with output information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00093">Undulator.h:93</a></div></div>
<div class="ttc" id="a05235_html_a0484e463f30b6e5da6964be8a80cbbf5"><div class="ttname"><a href="../../d8/dd0/a05235.html#a0484e463f30b6e5da6964be8a80cbbf5">Undulator::numPeriods_m</a></div><div class="ttdeci">unsigned int numPeriods_m</div><div class="ttdoc">Number of periods. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00087">Undulator.h:87</a></div></div>
<div class="ttc" id="a05235_html_a2ed1801511511a173222dbe516bd835a"><div class="ttname"><a href="../../d8/dd0/a05235.html#a2ed1801511511a173222dbe516bd835a">Undulator::totalTime_m</a></div><div class="ttdeci">double totalTime_m</div><div class="ttdoc">Total time to run undulator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00105">Undulator.h:105</a></div></div>
<div class="ttc" id="a04133_html_ac673bc430bdc3fdaa09f7becf98ef267"><div class="ttname"><a href="../../dc/d8f/a04133.html#ac673bc430bdc3fdaa09f7becf98ef267">name</a></div><div class="ttdeci">const std::string name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d8f/a04133_source.html#l00032">MaxNormRadialPeak.cpp:32</a></div></div>
<div class="ttc" id="a04735_html_abb205db2732109c056b0693e91913912"><div class="ttname"><a href="../../d9/d06/a04735.html#abb205db2732109c056b0693e91913912">PartBunchBase::get_centroid</a></div><div class="ttdeci">Vector_t get_centroid() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01105">PartBunchBase.hpp:1105</a></div></div>
<div class="ttc" id="a12119_html"><div class="ttname"><a href="../../d8/d4f/a12119.html">Inform</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2e/a03974_source.html#l00042">Inform.h:42</a></div></div>
<div class="ttc" id="a05235_html_a92c1b58c7d4e20f9201e165cb37551ea"><div class="ttname"><a href="../../d8/dd0/a05235.html#a92c1b58c7d4e20f9201e165cb37551ea">Undulator::getTotalTime</a></div><div class="ttdeci">double getTotalTime() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00333">Undulator.cpp:333</a></div></div>
<div class="ttc" id="a05235_html_af215cd9b3938aebeeaa2e62287f7199d"><div class="ttname"><a href="../../d8/dd0/a05235.html#af215cd9b3938aebeeaa2e62287f7199d">Undulator::k_m</a></div><div class="ttdeci">double k_m</div><div class="ttdoc">The undulator parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00081">Undulator.h:81</a></div></div>
<div class="ttc" id="a04735_html_a85872d4e8a718a8b38f259f879748eb9"><div class="ttname"><a href="../../d9/d06/a04735.html#a85872d4e8a718a8b38f259f879748eb9">PartBunchBase::toLabTrafo_m</a></div><div class="ttdeci">CoordinateSystemTrafo toLabTrafo_m</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00593">PartBunchBase.h:593</a></div></div>
<div class="ttc" id="a04735_html_a19aacd7d2904a811460d487ade713b9a"><div class="ttname"><a href="../../d9/d06/a04735.html#a19aacd7d2904a811460d487ade713b9a">PartBunchBase::getChargePerParticle</a></div><div class="ttdeci">double getChargePerParticle() const</div><div class="ttdoc">get the macro particle charge </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01323">PartBunchBase.hpp:1323</a></div></div>
<div class="ttc" id="a05235_html_a0d69e0773a2e3049ecb3c360381c562b"><div class="ttname"><a href="../../d8/dd0/a05235.html#a0d69e0773a2e3049ecb3c360381c562b">Undulator::angle_m</a></div><div class="ttdeci">double angle_m</div><div class="ttdoc">Polarisation angle of the undulator field. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00090">Undulator.h:90</a></div></div>
<div class="ttc" id="a05235_html_afb808bb698d1098fab823f21dac05037"><div class="ttname"><a href="../../d8/dd0/a05235.html#afb808bb698d1098fab823f21dac05037">Undulator::truncationOrder_m</a></div><div class="ttdeci">unsigned int truncationOrder_m</div><div class="ttdoc">First or second order absorbing boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00102">Undulator.h:102</a></div></div>
<div class="ttc" id="a00833_html"><div class="ttname"><a href="../../dc/d6e/a00833.html">Undulator.h</a></div></div>
<div class="ttc" id="a05019_html"><div class="ttname"><a href="../../de/d93/a05019.html">BeamlineVisitor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de6/a00548_source.html#l00079">BeamlineVisitor.h:79</a></div></div>
<div class="ttc" id="a04735_html_af792389ff15f7f9fe61a13138ff0d6f3"><div class="ttname"><a href="../../d9/d06/a04735.html#af792389ff15f7f9fe61a13138ff0d6f3">PartBunchBase::getT</a></div><div class="ttdeci">double getT() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01043">PartBunchBase.hpp:1043</a></div></div>
<div class="ttc" id="a04545_html_a7a0330f10eb09ae36017c24b9f45365b"><div class="ttname"><a href="../../de/d21/a04545.html#a7a0330f10eb09ae36017c24b9f45365b">mslang::iterator</a></div><div class="ttdeci">std::string::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d26/a02162_source.html#l00016">MSLang.h:16</a></div></div>
<div class="ttc" id="a05235_html_a027b6937b03cc0656e8c17a78db92848"><div class="ttname"><a href="../../d8/dd0/a05235.html#a027b6937b03cc0656e8c17a78db92848">Undulator::getType</a></div><div class="ttdeci">virtual ElementType getType() const</div><div class="ttdoc">Get element type std::string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00270">Undulator.cpp:270</a></div></div>
<div class="ttc" id="a04735_html_a04201304aaa3d56b1f1c50e9c017fc37"><div class="ttname"><a href="../../d9/d06/a04735.html#a04201304aaa3d56b1f1c50e9c017fc37">PartBunchBase::R</a></div><div class="ttdeci">ParticlePos_t &amp; R</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00570">PartBunchBase.h:570</a></div></div>
<div class="ttc" id="a00989_html"><div class="ttname"><a href="../../d4/d95/a00989.html">PartBunchBase.h</a></div></div>
<div class="ttc" id="a05235_html_ae715aff40c7d3c21afd7f80d53123573"><div class="ttname"><a href="../../d8/dd0/a05235.html#ae715aff40c7d3c21afd7f80d53123573">Undulator::hasBeenSimulated_m</a></div><div class="ttdeci">bool hasBeenSimulated_m</div><div class="ttdoc">Boolean to indicate whether this undulator has already been simulated. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00111">Undulator.h:111</a></div></div>
<div class="ttc" id="a05235_html_a994492c7c6fd28bc670d0dd1a878ebe9"><div class="ttname"><a href="../../d8/dd0/a05235.html#a994492c7c6fd28bc670d0dd1a878ebe9">Undulator::dtBunch_m</a></div><div class="ttdeci">double dtBunch_m</div><div class="ttdoc">Time step for the bunch position update. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/a00833_source.html#l00108">Undulator.h:108</a></div></div>
<div class="ttc" id="a04735_html_addc3c351123a7c560c34507b2fa67b5c"><div class="ttname"><a href="../../d9/d06/a04735.html#addc3c351123a7c560c34507b2fa67b5c">PartBunchBase::setT</a></div><div class="ttdeci">void setT(double t)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01031">PartBunchBase.hpp:1031</a></div></div>
<div class="ttc" id="a00908_html_a7a49daa94331dcd77650d976f3030012"><div class="ttname"><a href="../../d0/d85/a00908.html#a7a49daa94331dcd77650d976f3030012">euclidean_norm</a></div><div class="ttdeci">T euclidean_norm(const Vector&lt; T &gt; &amp;)</div><div class="ttdoc">Euclidean norm. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d85/a00908_source.html#l00243">Vector.h:243</a></div></div>
<div class="ttc" id="a04735_html_a4951c53df6841fd275a56f41fc76bfdf"><div class="ttname"><a href="../../d9/d06/a04735.html#a4951c53df6841fd275a56f41fc76bfdf">PartBunchBase::getdT</a></div><div class="ttdeci">double getdT() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01025">PartBunchBase.hpp:1025</a></div></div>
<div class="ttc" id="a05235_html_a101b1754532ab305e53866381a22b4bd"><div class="ttname"><a href="../../d8/dd0/a05235.html#a101b1754532ab305e53866381a22b4bd">Undulator::getMeshLength</a></div><div class="ttdeci">std::vector&lt; double &gt; getMeshLength() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00312">Undulator.cpp:312</a></div></div>
<div class="ttc" id="a05235_html_a8e655e610052ab025af7746d7ffad928"><div class="ttname"><a href="../../d8/dd0/a05235.html#a8e655e610052ab025af7746d7ffad928">Undulator::Undulator</a></div><div class="ttdeci">Undulator()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00042">Undulator.cpp:42</a></div></div>
<div class="ttc" id="a05235_html_a719a1264567c3f02681bec8ee52b8b67"><div class="ttname"><a href="../../d8/dd0/a05235.html#a719a1264567c3f02681bec8ee52b8b67">Undulator::finalise</a></div><div class="ttdeci">virtual void finalise()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00260">Undulator.cpp:260</a></div></div>
<div class="ttc" id="a04735_html_a454432f563c82b70dd9799e8e42efcbc"><div class="ttname"><a href="../../d9/d06/a04735.html#a454432f563c82b70dd9799e8e42efcbc">PartBunchBase::P</a></div><div class="ttdeci">ParticleAttrib&lt; Vector_t &gt; P</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00574">PartBunchBase.h:574</a></div></div>
<div class="ttc" id="a05235_html_aeff0610dcacc322348e9600183cd213c"><div class="ttname"><a href="../../d8/dd0/a05235.html#aeff0610dcacc322348e9600183cd213c">Undulator::accept</a></div><div class="ttdeci">virtual void accept(BeamlineVisitor &amp;) const</div><div class="ttdoc">Apply visitor to Undulator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00078">Undulator.cpp:78</a></div></div>
<div class="ttc" id="a05235_html_a478c3c617bf02247aa068b15d0e56950"><div class="ttname"><a href="../../d8/dd0/a05235.html#a478c3c617bf02247aa068b15d0e56950">Undulator::setMeshLength</a></div><div class="ttdeci">void setMeshLength(const std::vector&lt; double &gt; &amp;ml)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00309">Undulator.cpp:309</a></div></div>
<div class="ttc" id="a00893_html_aff5fe19fcdf8761618dbaf37b209a9c6"><div class="ttname"><a href="../../dc/d2c/a00893.html#aff5fe19fcdf8761618dbaf37b209a9c6">sqrt</a></div><div class="ttdeci">Tps&lt; T &gt; sqrt(const Tps&lt; T &gt; &amp;x)</div><div class="ttdoc">Square root. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2c/a00893_source.html#l00091">TpsMath.h:91</a></div></div>
<div class="ttc" id="a04735_html_a5d3f889cb1da052c04f1ce823946467f"><div class="ttname"><a href="../../d9/d06/a04735.html#a5d3f889cb1da052c04f1ce823946467f">PartBunchBase::RefPartR_m</a></div><div class="ttdeci">Vector_t RefPartR_m</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/a00989_source.html#l00590">PartBunchBase.h:590</a></div></div>
<div class="ttc" id="a05235_html_ab3ac86465d2e7c5476c489850f722934"><div class="ttname"><a href="../../d8/dd0/a05235.html#ab3ac86465d2e7c5476c489850f722934">Undulator::getAngle</a></div><div class="ttdeci">double getAngle() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00298">Undulator.cpp:298</a></div></div>
<div class="ttc" id="a05235_html_a8d469abb98100bd326f390689b60a127"><div class="ttname"><a href="../../d8/dd0/a05235.html#a8d469abb98100bd326f390689b60a127">Undulator::initialise</a></div><div class="ttdeci">virtual void initialise(PartBunchBase&lt; double, 3 &gt; *bunch, double &amp;startField, double &amp;endField)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00082">Undulator.cpp:82</a></div></div>
<div class="ttc" id="a00548_html"><div class="ttname"><a href="../../dd/de6/a00548.html">BeamlineVisitor.h</a></div></div>
<div class="ttc" id="a05235_html_a7b649ce80dd34cdfe9e29849d6f7df20"><div class="ttname"><a href="../../d8/dd0/a05235.html#a7b649ce80dd34cdfe9e29849d6f7df20">Undulator::setNumPeriods</a></div><div class="ttdeci">void setNumPeriods(unsigned int np)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daf/a00830_source.html#l00288">Undulator.cpp:288</a></div></div>
<div class="ttc" id="a04735_html_a1f81217882e2f010b529837e0abc8889"><div class="ttname"><a href="../../d9/d06/a04735.html#a1f81217882e2f010b529837e0abc8889">PartBunchBase::getLocalNum</a></div><div class="ttdeci">size_t getLocalNum() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d76/a00992_source.html#l01905">PartBunchBase.hpp:1905</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 29 2026 15:01:30 for OPAL (Object Oriented Parallel Accelerator Library) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
